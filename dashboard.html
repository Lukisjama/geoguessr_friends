<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GeoGuessr Results Dashboard</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.15);
        }

        .card h2 {
            color: #4a5568;
            margin-bottom: 20px;
            font-size: 1.4rem;
            border-bottom: 2px solid #e2e8f0;
            padding-bottom: 10px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .stat-number {
            font-size: 2rem;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 5px;
        }

        .stat-label {
            color: #718096;
            font-size: 0.9rem;
        }

        .leaderboard {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .leaderboard h2 {
            color: #4a5568;
            margin-bottom: 20px;
            font-size: 1.4rem;
            border-bottom: 2px solid #e2e8f0;
            padding-bottom: 10px;
        }

        .player-row {
            display: flex;
            align-items: center;
            padding: 15px;
            margin-bottom: 10px;
            background: #f7fafc;
            border-radius: 10px;
            transition: background-color 0.3s ease;
        }

        .player-row:hover {
            background: #edf2f7;
        }

        .player-rank {
            font-size: 1.5rem;
            font-weight: bold;
            color: #667eea;
            margin-right: 15px;
            min-width: 30px;
        }

        .player-name {
            flex: 1;
            font-weight: 600;
            color: #2d3748;
        }

        .player-stats {
            display: flex;
            gap: 20px;
            color: #718096;
            font-size: 0.9rem;
        }

        .player-stats-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .player-stats-table th,
        .player-stats-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e2e8f0;
        }

        .player-stats-table th {
            background-color: #f7fafc;
            font-weight: 600;
            color: #4a5568;
        }

        .player-stats-table tr:hover {
            background-color: #f7fafc;
        }

        .player-stats-table .player-name {
            font-weight: 600;
            color: #2d3748;
        }

        .player-stats-table .stat-value {
            font-weight: 500;
            color: #667eea;
        }
        
        .download-links {
            font-size: 0.8rem;
            max-width: 150px;
        }
        
        .download-link {
            color: #667eea;
            text-decoration: none;
            display: inline-block;
            margin: 2px 0;
            padding: 2px 4px;
            border-radius: 4px;
            background: rgba(102, 126, 234, 0.1);
            transition: all 0.2s ease;
        }
        
        .download-link:hover {
            background: rgba(102, 126, 234, 0.2);
            transform: translateY(-1px);
        }
        
        .challenges-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        
        .challenges-table th,
        .challenges-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e2e8f0;
        }
        
        .challenges-table th {
            background-color: #f7fafc;
            font-weight: 600;
            color: #4a5568;
        }
        
        .challenges-table tr:hover {
            background-color: #f7fafc;
        }
        
        .challenge-id {
            font-family: monospace;
            font-size: 0.9rem;
            color: #2d3748;
        }
        
        .download-cell {
            text-align: center;
        }
        
        .status-cell {
            text-align: center;
        }
        
        .status-loaded {
            color: #38a169;
            font-weight: 500;
        }
        
        .status-missing {
            color: #e53e3e;
            font-weight: 500;
        }

        .chart-container {
            position: relative;
            height: 300px;
            margin-top: 20px;
        }

        .filters {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .filter-group {
            display: flex;
            gap: 15px;
            align-items: center;
            flex-wrap: wrap;
        }

        .filter-group label {
            font-weight: 600;
            color: #4a5568;
        }

        .filter-group select {
            padding: 8px 12px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            background: white;
            color: #4a5568;
            font-size: 0.9rem;
        }

        .filter-group select:focus {
            outline: none;
            border-color: #667eea;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: white;
            font-size: 1.1rem;
        }

        .error {
            background: #fed7d7;
            color: #c53030;
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
            text-align: center;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .dashboard {
                grid-template-columns: 1fr;
            }
            
            .filter-group {
                flex-direction: column;
                align-items: stretch;
            }
            
            .player-stats {
                flex-direction: column;
                gap: 5px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🎯 GeoGuessr Results Dashboard</h1>
            <p>Track your geography skills and compete with friends!</p>
        </div>

        <div id="loading" class="loading">
            Loading your GeoGuessr data...
        </div>

        <div id="error" class="error" style="display: none;">
            Error loading data. Please check your CSV file.
        </div>

        <div id="dashboard" style="display: none;">
            <div class="filters">
                <div class="filter-group">
                    <label for="playerFilter">Player:</label>
                    <select id="playerFilter">
                        <option value="all">All Players</option>
                    </select>
                    
                    <label for="mapFilter">Map:</label>
                    <select id="mapFilter">
                        <option value="all">All Maps</option>
                    </select>
                    
                    <label for="gameFilter">Game:</label>
                    <select id="gameFilter">
                        <option value="all">All Games</option>
                    </select>
                </div>
            </div>

            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number" id="totalGames">-</div>
                    <div class="stat-label">Total Games</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="worstScore">-</div>
                    <div class="stat-label">Worst Score</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="avgScore">-</div>
                    <div class="stat-label">Average Score</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="bestScore">-</div>
                    <div class="stat-label" id="bestScoreLabel">Best Score</div>
                </div>
            </div>

            <div class="card">
                <h2>📊 Player Statistics</h2>
                <div id="playerStatsTable">
                    <!-- Player stats will be populated here -->
                </div>
            </div>

            <div class="card">
                <h2>🎯 Challenges</h2>
                <div id="challengesTable">
                    <!-- Challenges table will be populated here -->
                </div>
            </div>

            <div class="dashboard">
                <div class="leaderboard">
                    <h2>🏆 Leaderboard - Most Wins</h2>
                    <div id="winsLeaderboardContent">
                        <!-- Wins leaderboard will be populated here -->
                    </div>
                </div>

                <div class="leaderboard">
                    <h2>📊 Leaderboard - Average Total Points</h2>
                    <div id="pointsLeaderboardContent">
                        <!-- Points leaderboard will be populated here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let gameData = [];
        let charts = {};

        // Load CSV data
        async function loadData() {
            try {
                const response = await fetch('geoguessr_results.csv');
                const csvText = await response.text();
                gameData = parseCSV(csvText);
                
                if (gameData.length === 0) {
                    throw new Error('No data found in CSV');
                }
                
                initializeDashboard();
            } catch (error) {
                console.error('Error loading data:', error);
                document.getElementById('loading').style.display = 'none';
                document.getElementById('error').style.display = 'block';
            }
        }

        // Parse CSV data
        function parseCSV(csvText) {
            const lines = csvText.split('\n');
            const headers = lines[0].split(',');
            const data = [];
            
            for (let i = 1; i < lines.length; i++) {
                if (lines[i].trim()) {
                    const values = parseCSVLine(lines[i]);
                    if (values.length === headers.length) {
                        const row = {};
                        headers.forEach((header, index) => {
                            row[header.trim()] = values[index] ? values[index].trim() : '';
                        });
                        data.push(row);
                    }
                }
            }
            
            return data;
        }

        // Parse CSV line handling quoted values
        function parseCSVLine(line) {
            const result = [];
            let current = '';
            let inQuotes = false;
            
            for (let i = 0; i < line.length; i++) {
                const char = line[i];
                
                if (char === '"') {
                    inQuotes = !inQuotes;
                } else if (char === ',' && !inQuotes) {
                    result.push(current);
                    current = '';
                } else {
                    current += char;
                }
            }
            
            result.push(current);
            return result;
        }

        // Initialize dashboard
        async function initializeDashboard() {
            document.getElementById('loading').style.display = 'none';
            document.getElementById('dashboard').style.display = 'block';
            
            populateFilters();
            updateStats();
            createPlayerStatsTable();
            await createChallengesTable();
            updateLeaderboards();
            
            // Add event listeners
            document.getElementById('playerFilter').addEventListener('change', updateDashboard);
            document.getElementById('gameFilter').addEventListener('change', updateDashboard);
            document.getElementById('mapFilter').addEventListener('change', updateDashboard);
        }

        // Populate filter dropdowns
        function populateFilters() {
            const players = [...new Set(gameData.map(row => row.player_name).filter(name => name))];
            const games = [...new Set(gameData.map(row => row.challenge_title || row.file_name).filter(name => name))];
            const maps = [...new Set(gameData.map(row => row.map_name).filter(name => name))];
            
            const playerFilter = document.getElementById('playerFilter');
            const gameFilter = document.getElementById('gameFilter');
            const mapFilter = document.getElementById('mapFilter');
            
            players.forEach(player => {
                const option = document.createElement('option');
                option.value = player;
                option.textContent = player;
                playerFilter.appendChild(option);
            });
            
            games.forEach(game => {
                const option = document.createElement('option');
                option.value = game;
                option.textContent = game;
                gameFilter.appendChild(option);
            });
            
            maps.forEach(map => {
                const option = document.createElement('option');
                option.value = map;
                option.textContent = map;
                mapFilter.appendChild(option);
            });
        }

        // Update statistics
        function updateStats() {
            const totalGames = new Set(gameData.map(row => row.file_name)).size;
            const scores = gameData.map(row => parseInt(row.total_points) || 0).filter(score => score > 0);
            const avgScore = scores.length > 0 ? Math.round(scores.reduce((a, b) => a + b, 0) / scores.length) : 0;
            
            // Find best score and player
            let bestScore = 0;
            let bestPlayer = '';
            let worstScore = Infinity;
            let worstPlayer = '';
            
            gameData.forEach(row => {
                const score = parseInt(row.total_points) || 0;
                if (score > 0) {
                    if (score > bestScore) {
                        bestScore = score;
                        bestPlayer = row.player_name;
                    }
                    if (score < worstScore) {
                        worstScore = score;
                        worstPlayer = row.player_name;
                    }
                }
            });
            
            document.getElementById('totalGames').textContent = totalGames;
            document.getElementById('worstScore').textContent = worstScore === Infinity ? '0' : worstScore.toLocaleString();
            document.getElementById('avgScore').textContent = avgScore.toLocaleString();
            document.getElementById('bestScore').textContent = bestScore.toLocaleString();
            document.getElementById('bestScoreLabel').textContent = `Best Score by ${bestPlayer}`;
            
            // Add worst score info as a subtitle
            const worstScoreElement = document.getElementById('worstScore');
            const worstScoreLabel = worstScoreElement.parentElement.querySelector('.stat-label');
            if (worstScore !== Infinity) {
                worstScoreLabel.textContent = `Worst Score by ${worstPlayer}`;
            } else {
                worstScoreLabel.textContent = 'Worst Score';
            }
        }

        // Create player statistics table
        function createPlayerStatsTable() {
            const filteredData = getFilteredData();
            const playerStats = {};
            
            // Calculate stats for each player
            filteredData.forEach(row => {
                const player = row.player_name;
                if (!playerStats[player]) {
                    playerStats[player] = {
                        games: 0,
                        totalPoints: 0,
                        roundScores: [],
                        totalScores: [],
                        wins: 0
                    };
                }
                
                playerStats[player].games += 1;
                playerStats[player].totalPoints += parseInt(row.total_points) || 0;
                playerStats[player].totalScores.push(parseInt(row.total_points) || 0);
                
                // Collect round scores
                for (let round = 1; round <= 5; round++) {
                    const roundScore = parseInt(row[`round_${round}_points`]) || 0;
                    playerStats[player].roundScores.push(roundScore);
                }
                
                if (parseInt(row.position) === 1) {
                    playerStats[player].wins += 1;
                }
            });
            
            // Create table HTML
            let tableHTML = `
                <table class="player-stats-table">
                    <thead>
                        <tr>
                            <th>Player</th>
                            <th>Games</th>
                            <th>Wins</th>
                            <th>Avg Round Score</th>
                            <th>Avg Total Score</th>
                            <th>Max Round Score</th>
                            <th>Max Total Score</th>
                        </tr>
                    </thead>
                    <tbody>
            `;
            
            // Sort players by average total score
            const sortedPlayers = Object.keys(playerStats).sort((a, b) => {
                const avgA = playerStats[a].totalScores.reduce((sum, score) => sum + score, 0) / playerStats[a].totalScores.length;
                const avgB = playerStats[b].totalScores.reduce((sum, score) => sum + score, 0) / playerStats[b].totalScores.length;
                return avgB - avgA;
            });
            
            sortedPlayers.forEach(player => {
                const stats = playerStats[player];
                const avgRoundScore = Math.round(stats.roundScores.reduce((sum, score) => sum + score, 0) / stats.roundScores.length);
                const avgTotalScore = Math.round(stats.totalScores.reduce((sum, score) => sum + score, 0) / stats.totalScores.length);
                const maxRoundScore = Math.max(...stats.roundScores);
                const maxTotalScore = Math.max(...stats.totalScores);
                
                tableHTML += `
                    <tr>
                        <td class="player-name">${player}</td>
                        <td class="stat-value">${stats.games}</td>
                        <td class="stat-value">${stats.wins}</td>
                        <td class="stat-value">${avgRoundScore.toLocaleString()}</td>
                        <td class="stat-value">${avgTotalScore.toLocaleString()}</td>
                        <td class="stat-value">${maxRoundScore.toLocaleString()}</td>
                        <td class="stat-value">${maxTotalScore.toLocaleString()}</td>
                    </tr>
                `;
            });
            
            tableHTML += `
                    </tbody>
                </table>
            `;
            
            document.getElementById('playerStatsTable').innerHTML = tableHTML;
        }

        // Create challenges table
        async function createChallengesTable() {
            const filteredData = getFilteredData();
            
            // Load challenges data
            const challengesData = await loadChallengesData();
            
            // Get all unique challenge IDs from the data
            const challengeIds = [...new Set(filteredData.map(row => row.challenge_id).filter(id => id))];
            
            // Use challenges from summary CSV if available, otherwise use CSV data
            const allChallengeIds = challengesData.length > 0 ? 
                challengesData.map(c => c.challenge_id) : 
                [...new Set(challengeIds)];
            
            // Create table HTML
            let tableHTML = `
                <table class="challenges-table">
                    <thead>
                        <tr>
                            <th>Challenge ID</th>
                            <th>Download Link</th>
                            <th>Data Loaded</th>
                            <th>Players</th>
                            <th>Games</th>
                        </tr>
                    </thead>
                    <tbody>
            `;
            
            // Sort challenges by ID
            allChallengeIds.sort();
            
            allChallengeIds.forEach(challengeId => {
                // Check if data is loaded (has entries in CSV)
                const challengeData = filteredData.filter(row => row.challenge_id === challengeId);
                const isDataLoaded = challengeData.length > 0;
                
                // Get unique players for this challenge
                const players = [...new Set(challengeData.map(row => row.player_name))];
                const playerCount = players.length;
                const gameCount = challengeData.length;
                
                // Create download link
                const downloadLink = `<a href="https://www.geoguessr.com/challenge/${challengeId}" target="_blank" class="download-link">Download</a>`;
                
                // Data loaded status
                const dataStatus = isDataLoaded ? 
                    `<span class="status-loaded">✅ Yes (${gameCount} games)</span>` : 
                    `<span class="status-missing">❌ No</span>`;
                
                tableHTML += `
                    <tr>
                        <td class="challenge-id">${challengeId}</td>
                        <td class="download-cell">${downloadLink}</td>
                        <td class="status-cell">${dataStatus}</td>
                        <td class="stat-value">${playerCount}</td>
                        <td class="stat-value">${gameCount}</td>
                    </tr>
                `;
            });
            
            // Add a note about missing challenges
            if (allChallengeIds.length === 0) {
                tableHTML += `
                    <tr>
                        <td colspan="5" style="text-align: center; color: #718096; padding: 20px;">
                            No challenges found. Add .mhtml files to see challenges here.
                        </td>
                    </tr>
                `;
            }
            
            tableHTML += `
                    </tbody>
                </table>
            `;
            
            document.getElementById('challengesTable').innerHTML = tableHTML;
        }

        // Update dashboard based on filters
        async function updateDashboard() {
            createPlayerStatsTable();
            await createChallengesTable();
            updateLeaderboards();
        }

        // Update leaderboards
        function updateLeaderboards() {
            updateWinsLeaderboard();
            updatePointsLeaderboard();
        }

        // Update wins leaderboard
        function updateWinsLeaderboard() {
            const filteredData = getFilteredData();
            const playerStats = {};
            
            filteredData.forEach(row => {
                const player = row.player_name;
                if (!playerStats[player]) {
                    playerStats[player] = {
                        totalPoints: 0,
                        totalSteps: 0,
                        games: 0,
                        wins: 0
                    };
                }
                
                playerStats[player].totalPoints += parseInt(row.total_points) || 0;
                playerStats[player].totalSteps += parseInt(row.total_steps) || 0;
                playerStats[player].games += 1;
                
                if (parseInt(row.position) === 1) {
                    playerStats[player].wins += 1;
                }
            });
            
            // Sort by wins (descending)
            const sortedPlayers = Object.keys(playerStats).sort((a, b) => 
                playerStats[b].wins - playerStats[a].wins
            );
            
            const leaderboardContent = document.getElementById('winsLeaderboardContent');
            leaderboardContent.innerHTML = '';
            
            sortedPlayers.forEach((player, index) => {
                const stats = playerStats[player];
                const avgPoints = Math.round(stats.totalPoints / stats.games);
                const avgSteps = Math.round(stats.totalSteps / stats.games);
                
                const row = document.createElement('div');
                row.className = 'player-row';
                row.innerHTML = `
                    <div class="player-rank">${index + 1}</div>
                    <div class="player-name">${player}</div>
                    <div class="player-stats">
                        <span>🏆 ${stats.wins} wins</span>
                        <span>📊 ${avgPoints.toLocaleString()} avg pts</span>
                        <span>👣 ${avgSteps} avg steps</span>
                        <span>🎮 ${stats.games} games</span>
                    </div>
                `;
                leaderboardContent.appendChild(row);
            });
        }

        // Update points leaderboard
        function updatePointsLeaderboard() {
            const filteredData = getFilteredData();
            const playerStats = {};
            
            filteredData.forEach(row => {
                const player = row.player_name;
                if (!playerStats[player]) {
                    playerStats[player] = {
                        totalPoints: 0,
                        totalSteps: 0,
                        games: 0,
                        wins: 0
                    };
                }
                
                playerStats[player].totalPoints += parseInt(row.total_points) || 0;
                playerStats[player].totalSteps += parseInt(row.total_steps) || 0;
                playerStats[player].games += 1;
                
                if (parseInt(row.position) === 1) {
                    playerStats[player].wins += 1;
                }
            });
            
            // Sort by average total points (descending)
            const sortedPlayers = Object.keys(playerStats).sort((a, b) => {
                const avgA = playerStats[a].totalPoints / playerStats[a].games;
                const avgB = playerStats[b].totalPoints / playerStats[b].games;
                return avgB - avgA;
            });
            
            const leaderboardContent = document.getElementById('pointsLeaderboardContent');
            leaderboardContent.innerHTML = '';
            
            sortedPlayers.forEach((player, index) => {
                const stats = playerStats[player];
                const avgPoints = Math.round(stats.totalPoints / stats.games);
                const avgSteps = Math.round(stats.totalSteps / stats.games);
                
                const row = document.createElement('div');
                row.className = 'player-row';
                row.innerHTML = `
                    <div class="player-rank">${index + 1}</div>
                    <div class="player-name">${player}</div>
                    <div class="player-stats">
                        <span>🏆 ${stats.wins} wins</span>
                        <span>📊 ${avgPoints.toLocaleString()} avg pts</span>
                        <span>👣 ${avgSteps} avg steps</span>
                        <span>🎮 ${stats.games} games</span>
                    </div>
                `;
                leaderboardContent.appendChild(row);
            });
        }

        // Get filtered data based on current filters
        function getFilteredData() {
            const playerFilter = document.getElementById('playerFilter').value;
            const gameFilter = document.getElementById('gameFilter').value;
            const mapFilter = document.getElementById('mapFilter').value;
            
            return gameData.filter(row => {
                const playerMatch = playerFilter === 'all' || row.player_name === playerFilter;
                const gameMatch = gameFilter === 'all' || 
                    (row.challenge_title || row.file_name) === gameFilter;
                const mapMatch = mapFilter === 'all' || row.map_name === mapFilter;
                return playerMatch && gameMatch && mapMatch;
            });
        }

        // Helper functions
        function getPlayerColor(index, alpha = 1) {
            const colors = [
                `rgba(102, 126, 234, ${alpha})`,
                `rgba(118, 75, 162, ${alpha})`,
                `rgba(237, 100, 166, ${alpha})`,
                `rgba(255, 159, 67, ${alpha})`,
                `rgba(46, 204, 113, ${alpha})`,
                `rgba(52, 152, 219, ${alpha})`,
                `rgba(155, 89, 182, ${alpha})`,
                `rgba(230, 126, 34, ${alpha})`
            ];
            return colors[index % colors.length];
        }

        function parseDuration(durationStr) {
            if (!durationStr) return 0;
            
            const parts = durationStr.split(',');
            let totalMinutes = 0;
            
            parts.forEach(part => {
                part = part.trim();
                if (part.includes('min')) {
                    const minutes = parseInt(part.match(/(\d+)\s*min/)?.[1] || 0);
                    totalMinutes += minutes;
                }
                if (part.includes('sec')) {
                    const seconds = parseInt(part.match(/(\d+)\s*sec/)?.[1] || 0);
                    totalMinutes += seconds / 60;
                }
            });
            
            return totalMinutes;
        }

        // Load challenges data
        async function loadChallengesData() {
            try {
                const response = await fetch('challenges_summary.csv');
                const csvText = await response.text();
                const lines = csvText.split('\n');
                const headers = lines[0].split(',');
                
                const challenges = [];
                for (let i = 1; i < lines.length; i++) {
                    if (lines[i].trim()) {
                        const values = lines[i].split(',');
                        const challenge = {};
                        headers.forEach((header, index) => {
                            challenge[header] = values[index] || '';
                        });
                        challenges.push(challenge);
                    }
                }
                
                return challenges;
            } catch (error) {
                console.log('Challenges summary CSV not found, using CSV data only');
                return [];
            }
        }
    </script>
</body>
</html>
